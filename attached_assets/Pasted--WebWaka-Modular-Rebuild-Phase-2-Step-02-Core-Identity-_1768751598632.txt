
WebWaka Modular Rebuild

Phase 2 â€” Step 02: Core Identity

Platform: Replit

Repo: changerplanet/webwaka-core-identity

Branch: main (DIRECT COMMIT ALLOWED)

â¸»

CONTEXT

You are implementing Phase 2 â€“ Step 02 of the WebWaka Modular Rebuild.

This task builds the canonical identity core used by all Suites and Industry modules.

This is a TypeScript-only, headless library.

â¸»

NON-NEGOTIABLE RULES
	1.	Clone the repository FIRST

https://github.com/changerplanet/webwaka-core-identity


	2.	Work directly on main
	â€¢	No branches
	â€¢	No rebases
	â€¢	No force pushes
	3.	Technology constraints
	â€¢	TypeScript only
	â€¢	No UI
	â€¢	No framework
	â€¢	No backend/server
	â€¢	No frontend folders
	4.	Do not add any scaffolding
	â€¢	NO /frontend
	â€¢	NO /backend
	â€¢	NO hidden config directories

â¸»

OSS DECISION (ALREADY APPROVED)

Use Clerk as the Identity Provider.
	â€¢	This module is a Clerk adapter + resolver
	â€¢	Authentication happens outside this module
	â€¢	Mock Clerk in tests

â¸»

REQUIRED CAPABILITIES

Expose a clean IdentityService with:
	â€¢	resolveIdentity(sessionToken)
	â€¢	getUser(tenantId, userId)
	â€¢	getUserByPhone(tenantId, phone)
	â€¢	getUserByEmail(tenantId, email)
	â€¢	listUsers(tenantId)
	â€¢	assertTenantContext(sessionToken)

Rules
	â€¢	Nigeria-first phone normalization (+234)
	â€¢	Strict tenant isolation
	â€¢	Provider-agnostic interface
	â€¢	No PII leakage

â¸»

MANIFEST REQUIREMENTS

Update module.manifest.json:
	â€¢	moduleId: webwaka-core-identity
	â€¢	class: core
	â€¢	dependencies:
	â€¢	webwaka-core-registry
	â€¢	Capabilities:
	â€¢	identity:resolve
	â€¢	identity:get-user
	â€¢	identity:list-users

â¸»

TESTING
	â€¢	Jest or Vitest
	â€¢	â‰¥ 80% coverage
	â€¢	Tests MUST prove:
	â€¢	Tenant isolation
	â€¢	Phone normalization
	â€¢	Clerk adapter behavior
	â€¢	Identity resolution

â¸»

HARD STOP CONDITION (MANDATORY)

A Suite can provide a session token and reliably receive
(tenantId, userId, roles, identity metadata)

If this is not demonstrably true â†’ STOP.

â¸»

DELIVERY
	1.	Commit directly to main
	2.	Push to GitHub
	3.	Provide a completion summary:
	â€¢	Files added
	â€¢	APIs exposed
	â€¢	Coverage
	â€¢	Hard stop proof

Then STOP and wait for authorization.

â¸»

ðŸš« DO NOT PROCEED TO STEP 03 WITHOUT EXPLICIT APPROVAL

â¸»